<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>书签助手</title>
  <link rel="icon" type="image/svg+xml" href="images/icon.svg">
  <link rel="stylesheet" href="styles/apple-design-system.css">
  <style>
    body {
      width: 400px;
      min-height: 520px;
      overflow-x: hidden;
    }

    .popup-container {
      padding: 20px;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Header */
    .popup-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      padding-bottom: 14px;
      border-bottom: 1px solid var(--apple-divider);
    }

    .popup-header-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .popup-logo {
      width: 32px;
      height: 32px;
      border-radius: 8px;
    }

    .popup-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--apple-text);
    }

    /* API Status */
    .api-status {
      display: flex;
      align-items: center;
      gap: 5px;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: 600;
    }

    .api-connected {
      background: var(--apple-success-bg);
      color: var(--apple-success);
    }

    .api-not-connected {
      background: var(--apple-danger-bg);
      color: var(--apple-danger);
    }

    .api-status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
    }

    /* Stats */
    .popup-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
      margin-bottom: 20px;
    }

    .popup-stat {
      background: var(--apple-bg-tertiary);
      border: 1px solid var(--apple-border);
      border-radius: var(--apple-radius-md);
      padding: 10px 8px;
      text-align: center;
    }

    .popup-stat-value {
      display: block;
      font-size: 20px;
      font-weight: 600;
      color: var(--apple-accent);
      letter-spacing: -0.3px;
    }

    .popup-stat-label {
      font-size: 10px;
      font-weight: 500;
      color: var(--apple-text-secondary);
      margin-top: 2px;
    }

    /* Category Section */
    .popup-section {
      margin-bottom: 16px;
    }

    .popup-section-title {
      font-size: 11px;
      font-weight: 600;
      color: var(--apple-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 8px;
      padding-left: 2px;
    }

    .popup-section-grid {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    /* Button */
    .popup-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 10px 14px;
      background: var(--apple-bg-tertiary);
      border: 1px solid var(--apple-border);
      border-radius: var(--apple-radius-sm);
      font-size: 13px;
      font-weight: 500;
      font-family: var(--apple-font);
      color: var(--apple-text);
      cursor: pointer;
      text-align: left;
      transition: all var(--apple-duration-fast) var(--apple-ease);
    }

    .popup-btn:hover {
      background: var(--apple-bg-hover);
      border-color: var(--apple-border-focus);
      transform: translateY(-0.5px);
      box-shadow: var(--apple-shadow-sm);
    }

    .popup-btn:active {
      transform: translateY(0) scale(0.99);
    }

    .popup-btn.loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .popup-btn-icon {
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 7px;
      flex-shrink: 0;
    }

    .popup-btn-icon svg {
      width: 16px;
      height: 16px;
    }

    .popup-btn-text {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .popup-btn-badge {
      font-size: 10px;
      font-weight: 600;
      padding: 1px 6px;
      border-radius: 8px;
      flex-shrink: 0;
    }

    /* Icon background colors */
    .icon-blue {
      background: var(--apple-accent-bg);
      color: var(--apple-accent);
    }

    .icon-green {
      background: var(--apple-success-bg);
      color: var(--apple-success);
    }

    .icon-orange {
      background: var(--apple-warning-bg);
      color: var(--apple-warning);
    }

    .icon-red {
      background: var(--apple-danger-bg);
      color: var(--apple-danger);
    }

    .icon-purple {
      background: var(--apple-info-bg);
      color: var(--apple-info);
    }

    .badge-blue {
      background: var(--apple-accent-bg);
      color: var(--apple-accent);
    }

    .badge-green {
      background: var(--apple-success-bg);
      color: var(--apple-success);
    }

    .badge-orange {
      background: var(--apple-warning-bg);
      color: var(--apple-warning);
    }

    /* Primary action button */
    .popup-btn-primary {
      background: var(--apple-accent);
      border-color: transparent;
      color: #ffffff;
    }

    .popup-btn-primary:hover {
      background: var(--apple-accent-hover);
      border-color: transparent;
    }

    .popup-btn-primary .popup-btn-icon {
      background: rgba(255, 255, 255, 0.2);
      color: #ffffff;
    }

    .popup-btn-primary .popup-btn-badge {
      background: rgba(255, 255, 255, 0.25);
      color: #ffffff;
    }

    /* Footer */
    .popup-footer {
      margin-top: auto;
      padding-top: 12px;
      border-top: 1px solid var(--apple-divider);
      text-align: center;
      font-size: 11px;
      color: var(--apple-text-tertiary);
    }

    @media (prefers-reduced-motion: reduce) {

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>

<body>
  <div class="popup-container">
    <!-- Header -->
    <div class="popup-header">
      <div class="popup-header-left">
        <img src="images/icon.svg" alt="书签助手" class="popup-logo">
        <span class="popup-title">书签助手</span>
      </div>
      <div class="api-status" id="api-status-container">
        <span class="api-status-dot"></span>
        <span id="api-status-text">检查中...</span>
      </div>
    </div>

    <!-- 快速统计 -->
    <div class="popup-stats">
      <div class="popup-stat">
        <span class="popup-stat-value" id="total-bookmarks">-</span>
        <span class="popup-stat-label">总书签</span>
      </div>
      <div class="popup-stat">
        <span class="popup-stat-value" id="total-folders">-</span>
        <span class="popup-stat-label">文件夹</span>
      </div>
      <div class="popup-stat">
        <span class="popup-stat-value" id="duplicate-count">-</span>
        <span class="popup-stat-label">重复</span>
      </div>
    </div>

    <!-- AI 智能 -->
    <div class="popup-section">
      <div class="popup-section-title">AI 智能</div>
      <div class="popup-section-grid">
        <button id="open-ai-hub" class="popup-btn popup-btn-primary">
          <span class="popup-btn-icon" data-icon="rocket" data-icon-size="16"></span>
          <span class="popup-btn-text">AI 智能中枢</span>
          <span class="popup-btn-badge">NEW</span>
        </button>
        <button id="quick-analysis" class="popup-btn">
          <span class="popup-btn-icon icon-green" data-icon="zap" data-icon-size="16"></span>
          <span class="popup-btn-text">快速 AI 分析</span>
        </button>
      </div>
    </div>

    <!-- 主要功能 -->
    <div class="popup-section">
      <div class="popup-section-title">主要功能</div>
      <div class="popup-section-grid">
        <button id="open-visualization" class="popup-btn">
          <span class="popup-btn-icon icon-purple" data-icon="palette" data-icon-size="16"></span>
          <span class="popup-btn-text">书签可视化</span>
          <span class="popup-btn-badge badge-green">推荐</span>
        </button>
        <button id="open-manager" class="popup-btn">
          <span class="popup-btn-icon icon-blue" data-icon="folder" data-icon-size="16"></span>
          <span class="popup-btn-text">书签管理器</span>
        </button>
      </div>
    </div>

    <!-- 智能分析 -->
    <div class="popup-section">
      <div class="popup-section-title">智能分析</div>
      <div class="popup-section-grid">
        <button id="ai-analysis" class="popup-btn">
          <span class="popup-btn-icon icon-blue" data-icon="scan-search" data-icon-size="16"></span>
          <span class="popup-btn-text">AI 智能分析</span>
        </button>
        <button id="data-visualization" class="popup-btn">
          <span class="popup-btn-icon icon-purple" data-icon="bar-chart" data-icon-size="16"></span>
          <span class="popup-btn-text">数据可视化</span>
        </button>
        <button id="export-data" class="popup-btn">
          <span class="popup-btn-icon icon-green" data-icon="download" data-icon-size="16"></span>
          <span class="popup-btn-text">导出数据</span>
        </button>
      </div>
    </div>

    <!-- 数据管理 -->
    <div class="popup-section">
      <div class="popup-section-title">数据管理</div>
      <div class="popup-section-grid">
        <button id="batch-operations" class="popup-btn">
          <span class="popup-btn-icon icon-orange" data-icon="layers" data-icon-size="16"></span>
          <span class="popup-btn-text">批量操作</span>
        </button>
        <button id="import-export" class="popup-btn">
          <span class="popup-btn-icon icon-blue" data-icon="refresh-cw" data-icon-size="16"></span>
          <span class="popup-btn-text">导入导出</span>
        </button>
        <button id="backup-restore" class="popup-btn">
          <span class="popup-btn-icon icon-green" data-icon="save" data-icon-size="16"></span>
          <span class="popup-btn-text">备份恢复</span>
        </button>
      </div>
    </div>

    <!-- 检测清理 -->
    <div class="popup-section">
      <div class="popup-section-title">检测清理</div>
      <div class="popup-section-grid">
        <button id="detect-duplicates" class="popup-btn">
          <span class="popup-btn-icon icon-orange" data-icon="copy" data-icon-size="16"></span>
          <span class="popup-btn-text">检测重复</span>
          <span class="popup-btn-badge badge-orange" id="duplicate-badge" style="display: none;">0</span>
        </button>
        <button id="detect-invalid" class="popup-btn">
          <span class="popup-btn-icon icon-orange" data-icon="link-2" data-icon-size="16"></span>
          <span class="popup-btn-text">检测失效</span>
          <span class="popup-btn-badge badge-orange" id="invalid-badge" style="display: none;">0</span>
        </button>
        <button id="cleanup-bookmarks" class="popup-btn">
          <span class="popup-btn-icon icon-red" data-icon="trash" data-icon-size="16"></span>
          <span class="popup-btn-text">清理书签</span>
        </button>
      </div>
    </div>

    <!-- 设置 -->
    <div class="popup-section">
      <div class="popup-section-title">设置</div>
      <div class="popup-section-grid">
        <button id="personalization" class="popup-btn">
          <span class="popup-btn-icon icon-purple" data-icon="settings" data-icon-size="16"></span>
          <span class="popup-btn-text">个性化设置</span>
        </button>
        <button id="api-settings" class="popup-btn">
          <span class="popup-btn-icon icon-blue" data-icon="key" data-icon-size="16"></span>
          <span class="popup-btn-text">API 设置</span>
        </button>
      </div>
    </div>

    <!-- Footer -->
    <div class="popup-footer">
      书签助手 v1.0 · AI辅助书签整理
    </div>
  </div>

  <script src="styles/icons.js"></script>
  <script src="popup.js"></script>
</body>

</html>